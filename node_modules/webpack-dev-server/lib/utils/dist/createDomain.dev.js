'use strict';

var url = require('url');

var ip = require('internal-ip');

function createDomain(options, server) {
  var protocol = options.https ? 'https' : 'http';
  var hostname = options.useLocalIp ? ip.v4.sync() || 'localhost' : options.host || 'localhost'; // eslint-disable-next-line no-nested-ternary

  var port = options.socket ? 0 : server ? server.address().port : 0; // use explicitly defined public url
  // (prefix with protocol if not explicitly given)

  if (options["public"]) {
    return /^[a-zA-Z]+:\/\//.test(options["public"]) ? "".concat(options["public"]) : "".concat(protocol, "://").concat(options["public"]);
  } // the formatted domain (url without path) of the webpack server


  return url.format({
    protocol: protocol,
    hostname: hostname,
    port: port
  });
}

module.exports = createDomain;