'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = parseWsc;

var _postcss = require('postcss');

var _validateWsc = require('./validateWsc');

var none = /^\s*(none|medium)(\s+none(\s+(none|currentcolor))?)?\s*$/i;
var varRE = /(^.*var)(.*\(.*--.*\))(.*)/i;

var varPreserveCase = function varPreserveCase(p) {
  return "".concat(p[1].toLowerCase()).concat(p[2]).concat(p[3].toLowerCase());
};

var toLower = function toLower(v) {
  var match = varRE.exec(v);
  return match ? varPreserveCase(match) : v.toLowerCase();
};

function parseWsc(value) {
  if (none.test(value)) {
    return ['medium', 'none', 'currentcolor'];
  }

  var width, style, color;

  var values = _postcss.list.space(value);

  if (values.length > 1 && (0, _validateWsc.isStyle)(values[1]) && values[0].toLowerCase() === 'none') {
    values.unshift();
    width = '0';
  }

  var unknown = [];
  values.forEach(function (v) {
    if ((0, _validateWsc.isStyle)(v)) {
      style = toLower(v);
    } else if ((0, _validateWsc.isWidth)(v)) {
      width = toLower(v);
    } else if ((0, _validateWsc.isColor)(v)) {
      color = toLower(v);
    } else {
      unknown.push(v);
    }
  });

  if (unknown.length) {
    if (!width && style && color) {
      width = unknown.pop();
    }

    if (width && !style && color) {
      style = unknown.pop();
    }

    if (width && style && !color) {
      color = unknown.pop();
    }
  }

  return [width, style, color];
}

module.exports = exports['default'];