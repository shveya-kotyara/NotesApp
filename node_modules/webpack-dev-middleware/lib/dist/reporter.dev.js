'use strict';

module.exports = function reporter(middlewareOptions, options) {
  var log = options.log,
      state = options.state,
      stats = options.stats;

  if (state) {
    var displayStats = middlewareOptions.stats !== false;
    var statsString = stats.toString(middlewareOptions.stats); // displayStats only logged

    if (displayStats && statsString.trim().length) {
      if (stats.hasErrors()) {
        log.error(statsString);
      } else if (stats.hasWarnings()) {
        log.warn(statsString);
      } else {
        log.info(statsString);
      }
    }

    var message = 'Compiled successfully.';

    if (stats.hasErrors()) {
      message = 'Failed to compile.';
    } else if (stats.hasWarnings()) {
      message = 'Compiled with warnings.';
    }

    log.info(message);
  } else {
    log.info('Compiling...');
  }
};