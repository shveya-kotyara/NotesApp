"use strict";

var _require = require('path'),
    dirname = _require.dirname;

var findMade = function findMade(opts, parent) {
  var path = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;
  // we never want the 'made' return value to be a root directory
  if (path === parent) return Promise.resolve();
  return opts.statAsync(parent).then(function (st) {
    return st.isDirectory() ? path : undefined;
  }, // will fail later
  function (er) {
    return er.code === 'ENOENT' ? findMade(opts, dirname(parent), parent) : undefined;
  });
};

var findMadeSync = function findMadeSync(opts, parent) {
  var path = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;
  if (path === parent) return undefined;

  try {
    return opts.statSync(parent).isDirectory() ? path : undefined;
  } catch (er) {
    return er.code === 'ENOENT' ? findMadeSync(opts, dirname(parent), parent) : undefined;
  }
};

module.exports = {
  findMade: findMade,
  findMadeSync: findMadeSync
};