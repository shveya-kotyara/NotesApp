"use strict";

var platform = process.env.__TESTING_MKDIRP_PLATFORM__ || process.platform;

var _require = require('path'),
    resolve = _require.resolve,
    parse = _require.parse;

var pathArg = function pathArg(path) {
  if (/\0/.test(path)) {
    // simulate same failure that node raises
    throw Object.assign(new TypeError('path must be a string without null bytes'), {
      path: path,
      code: 'ERR_INVALID_ARG_VALUE'
    });
  }

  path = resolve(path);

  if (platform === 'win32') {
    var badWinChars = /[*|"<>?:]/;

    var _parse = parse(path),
        root = _parse.root;

    if (badWinChars.test(path.substr(root.length))) {
      throw Object.assign(new Error('Illegal characters in path.'), {
        path: path,
        code: 'EINVAL'
      });
    }
  }

  return path;
};

module.exports = pathArg;