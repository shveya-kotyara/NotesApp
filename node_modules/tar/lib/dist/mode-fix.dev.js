'use strict';

module.exports = function (mode, isDir, portable) {
  mode &= 4095; // in portable mode, use the minimum reasonable umask
  // if this system creates files with 0o664 by default
  // (as some linux distros do), then we'll write the
  // archive with 0o644 instead.  Also, don't ever create
  // a file that is not readable/writable by the owner.

  if (portable) {
    mode = (mode | 384) & ~18;
  } // if dirs are readable, then they should be listable


  if (isDir) {
    if (mode & 256) mode |= 64;
    if (mode & 32) mode |= 8;
    if (mode & 4) mode |= 1;
  }

  return mode;
};