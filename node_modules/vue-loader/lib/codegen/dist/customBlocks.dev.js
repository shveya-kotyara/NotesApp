"use strict";

var qs = require('querystring');

var _require = require('./utils'),
    attrsToQuery = _require.attrsToQuery;

module.exports = function genCustomBlocksCode(blocks, resourcePath, resourceQuery, stringifyRequest) {
  return "\n/* custom blocks */\n" + blocks.map(function (block, i) {
    var src = block.attrs.src || resourcePath;
    var attrsQuery = attrsToQuery(block.attrs);
    var issuerQuery = block.attrs.src ? "&issuerPath=".concat(qs.escape(resourcePath)) : '';
    var inheritQuery = resourceQuery ? "&".concat(resourceQuery.slice(1)) : '';
    var query = "?vue&type=custom&index=".concat(i, "&blockType=").concat(qs.escape(block.type)).concat(issuerQuery).concat(attrsQuery).concat(inheritQuery);
    return "import block".concat(i, " from ").concat(stringifyRequest(src + query), "\n") + "if (typeof block".concat(i, " === 'function') block").concat(i, "(component)");
  }).join("\n") + "\n";
};