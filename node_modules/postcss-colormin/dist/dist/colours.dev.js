'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _color = require('color');

var _color2 = _interopRequireDefault(_color);

var _keywords = require('./keywords.json');

var _keywords2 = _interopRequireDefault(_keywords);

var _toShorthand = require('./lib/toShorthand');

var _toShorthand2 = _interopRequireDefault(_toShorthand);

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    "default": obj
  };
}

var shorter = function shorter(a, b) {
  return (a && a.length < b.length ? a : b).toLowerCase();
};

exports["default"] = function (colour) {
  var isLegacy = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
  var cache = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
  var key = colour + "|" + isLegacy;

  if (cache && cache[key]) {
    return cache[key];
  }

  try {
    var parsed = (0, _color2["default"])(colour.toLowerCase());
    var alpha = parsed.alpha();

    if (alpha === 1) {
      var toHex = (0, _toShorthand2["default"])(parsed.hex().toLowerCase());
      var result = shorter(_keywords2["default"][toHex], toHex);

      if (cache) {
        cache[key] = result;
      }

      return result;
    } else {
      var rgb = parsed.rgb();

      if (!isLegacy && !rgb.color[0] && !rgb.color[1] && !rgb.color[2] && !alpha) {
        var _result2 = 'transparent';

        if (cache) {
          cache[key] = _result2;
        }

        return _result2;
      }

      var hsla = parsed.hsl().string();
      var rgba = rgb.string();

      var _result = hsla.length < rgba.length ? hsla : rgba;

      if (cache) {
        cache[key] = _result;
      }

      return _result;
    }
  } catch (e) {
    // Possibly malformed, so pass through
    var _result3 = colour;

    if (cache) {
      cache[key] = _result3;
    }

    return _result3;
  }
};