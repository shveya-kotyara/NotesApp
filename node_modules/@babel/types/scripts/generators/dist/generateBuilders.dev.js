"use strict";

var definitions = require("../../lib/definitions");

var formatBuilderName = require("../utils/formatBuilderName");

var lowerFirst = require("../utils/lowerFirst");

module.exports = function generateBuilders() {
  var output = "// @flow\n/*\n * This file is auto-generated! Do not modify it directly.\n * To re-generate run 'make build'\n */\nimport builder from \"../builder\";\n\n";
  var reservedNames = new Set(["super", "import"]);
  Object.keys(definitions.BUILDER_KEYS).forEach(function (type) {
    var formatedBuilderName = formatBuilderName(type);
    var formatedBuilderNameLocal = reservedNames.has(formatedBuilderName) ? "_".concat(formatedBuilderName) : formatedBuilderName;
    output += "".concat(formatedBuilderNameLocal === formatedBuilderName ? "export " : "", "function ").concat(formatedBuilderNameLocal, "(...args: Array<any>): Object { return builder(\"").concat(type, "\", ...args); }\n"); // This is needed for backwards compatibility.
    // arrayExpression -> ArrayExpression

    output += "export { ".concat(formatedBuilderNameLocal, " as ").concat(type, " };\n");

    if (formatedBuilderNameLocal !== formatedBuilderName) {
      output += "export { ".concat(formatedBuilderNameLocal, " as ").concat(formatedBuilderName, " };\n");
    } // This is needed for backwards compatibility.
    // It should be removed in the next major version.
    // JSXIdentifier -> jSXIdentifier


    if (/^[A-Z]{2}/.test(type)) {
      output += "export { ".concat(formatedBuilderNameLocal, " as ").concat(lowerFirst(type), " }\n");
    }
  });
  Object.keys(definitions.DEPRECATED_KEYS).forEach(function (type) {
    var newType = definitions.DEPRECATED_KEYS[type];
    output += "export function ".concat(type, "(...args: Array<any>): Object {\n  console.trace(\"The node type ").concat(type, " has been renamed to ").concat(newType, "\");\n  return builder(\"").concat(type, "\", ...args);\n}\nexport { ").concat(type, " as ").concat(formatBuilderName(type), " };\n"); // This is needed for backwards compatibility.
    // It should be removed in the next major version.
    // JSXIdentifier -> jSXIdentifier

    if (/^[A-Z]{2}/.test(type)) {
      output += "export { ".concat(type, " as ").concat(lowerFirst(type), " }\n");
    }
  });
  return output;
};